{% extends "admin/admin-base.html" %}

{% block title %}View Applicant - Admin Panel{% endblock %}

{% block content %}
<div class="page-header mb-4">
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <h1 class="page-title">{{ applicant.full_name }}</h1>
            <p class="page-subtitle">Application ID: #{{ applicant.id }} â€¢ Applied {{ applicant.applied_at.strftime('%b %d, %Y at %I:%M %p') }}</p>
        </div>
        <a href="{{ url_for('admin_applicants') }}" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left me-2"></i>Back to Applicants
        </a>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <!-- Applicant Details -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-user me-2"></i>Personal Information</h5>
            </div>
            <div class="card-body">
                <div class="row g-4">
                    <div class="col-md-6">
                        <div class="info-group">
                            <label style="color: var(--text-muted); font-size: 0.85rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Full Name</label>
                            <div style="color: var(--text-primary); font-size: 1.1rem; font-weight: 500; margin-top: 0.5rem;">{{ applicant.full_name }}</div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="info-group">
                            <label style="color: var(--text-muted); font-size: 0.85rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Email Address</label>
                            <div style="color: var(--text-primary); font-size: 1rem; margin-top: 0.5rem;">
                                <i class="fas fa-envelope me-2" style="color: var(--primary);"></i>
                                <a href="mailto:{{ applicant.email }}" style="color: var(--primary); text-decoration: none;">{{ applicant.email }}</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="info-group">
                            <label style="color: var(--text-muted); font-size: 0.85rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Phone Number</label>
                            <div style="color: var(--text-primary); font-size: 1rem; margin-top: 0.5rem;">
                                <i class="fas fa-phone me-2" style="color: var(--success);"></i>
                                <a href="tel:{{ applicant.phone }}" style="color: var(--text-primary); text-decoration: none;">{{ applicant.phone }}</a>
                            </div>
                        </div>
                    </div>
                    {% if applicant.linkedin_url %}
                    <div class="col-md-6">
                        <div class="info-group">
                            <label style="color: var(--text-muted); font-size: 0.85rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">LinkedIn Profile</label>
                            <div style="color: var(--text-primary); font-size: 1rem; margin-top: 0.5rem;">
                                <i class="fab fa-linkedin me-2" style="color: #0077b5;"></i>
                                <a href="{{ applicant.linkedin_url }}" target="_blank" style="color: var(--primary); text-decoration: none;">View Profile</a>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                    {% if applicant.portfolio_url %}
                    <div class="col-md-6">
                        <div class="info-group">
                            <label style="color: var(--text-muted); font-size: 0.85rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Portfolio</label>
                            <div style="color: var(--text-primary); font-size: 1rem; margin-top: 0.5rem;">
                                <i class="fas fa-globe me-2" style="color: var(--info);"></i>
                                <a href="{{ applicant.portfolio_url }}" target="_blank" style="color: var(--primary); text-decoration: none;">View Portfolio</a>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- Cover Letter -->
        {% if applicant.cover_letter %}
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-file-alt me-2"></i>Cover Letter</h5>
            </div>
            <div class="card-body">
                <div style="background: var(--dark-surface); padding: 1.5rem; border-radius: 10px; border-left: 4px solid var(--primary);">
                    <p style="white-space: pre-wrap; color: var(--text-primary); line-height: 1.8; margin: 0;">{{ applicant.cover_letter }}</p>
                </div>
            </div>
        </div>
        {% endif %}
        
        <!-- Resume -->
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-file-pdf me-2"></i>Resume / CV</h5>
            </div>
            <div class="card-body">
                <div class="d-flex align-items-center justify-content-between p-3" style="background: var(--dark-surface); border-radius: 10px;">
                    <div class="d-flex align-items-center">
                        <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #ef4444, #dc2626); border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
                            <i class="fas fa-file-pdf fa-lg" style="color: white;"></i>
                        </div>
                        <div>
                            <div style="font-weight: 600; color: var(--text-primary); max-width: 200px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                {{ applicant.resume_path }}
                            </div>
                            
                            <small style="color: var(--text-muted);">Uploaded on {{ applicant.applied_at.strftime('%b %d, %Y') }}</small>
                        </div>
                    </div>
                    <a href="{{ url_for('uploaded_file', filename=applicant.resume_path) }}" class="btn btn-primary" target="_blank">
                        <i class="fas fa-download me-2"></i>Preview
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <!-- Status Card -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-tasks me-2"></i>Application Status</h5>
            </div>
            <div class="card-body">
                <form method="POST" action="{{ url_for('update_applicant_status', id=applicant.id) }}">
                    <div class="mb-3">
                        <label class="form-label">Current Status</label>
                        <select name="status" class="form-select" id="statusSelect">
                            <option value="pending" {% if applicant.status == 'pending' %}selected{% endif %}>Pending Review</option>
                            <option value="reviewed" {% if applicant.status == 'reviewed' %}selected{% endif %}>Reviewed</option>
                            <option value="shortlisted" {% if applicant.status == 'shortlisted' %}selected{% endif %}>Shortlisted</option>
                            <option value="rejected" {% if applicant.status == 'rejected' %}selected{% endif %}>Rejected</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-save me-2"></i>Update Status
                    </button>
                </form>
            </div>
        </div>
        
        <!-- Internship Info -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-briefcase me-2"></i>Applied For</h5>
            </div>
            <div class="card-body">
                <h6 style="color: var(--text-primary); margin-bottom: 1rem;">{{ applicant.internship.title }}</h6>
                <div class="mb-2">
                    <small style="color: var(--text-muted);">Location:</small>
                    <div style="color: var(--text-primary);">
                        <i class="fas fa-map-marker-alt me-1"></i>{{ applicant.internship.location }}
                    </div>
                </div>
                <div class="mb-2">
                    <small style="color: var(--text-muted);">Duration:</small>
                    <div style="color: var(--text-primary);">{{ applicant.internship.duration or 'Not specified' }}</div>
                </div>
                <div class="mb-3">
                    <small style="color: var(--text-muted);">Stipend:</small>
                    <div style="color: var(--text-primary);">{{ applicant.internship.stipend or 'Not specified' }}</div>
                </div>
                <a href="{{ url_for('edit_internship', id=applicant.internship.id) }}" class="btn btn-outline-primary w-100 btn-sm">
                    <i class="fas fa-external-link-alt me-2"></i>View Internship
                </a>
            </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-bolt me-2"></i>Quick Actions</h5>
            </div>
            <div class="card-body">
                <a href="mailto:{{ applicant.email }}" class="btn btn-outline-primary w-100 mb-2">
                    <i class="fas fa-envelope me-2"></i>Send Email
                </a>
                <a href="tel:{{ applicant.phone }}" class="btn btn-outline-success w-100 mb-2">
                    <i class="fas fa-phone me-2"></i>Call Applicant
                </a>
                <a href="{{ url_for('admin_mail') }}" class="btn btn-outline-info w-100">
                    <i class="fas fa-paper-plane me-2"></i>Bulk Email
                </a>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
    document.getElementById('statusSelect').addEventListener('change', function() {
        const select = this;
        const colors = {
            'pending': 'var(--warning)',
            'reviewed': 'var(--info)',
            'shortlisted': 'var(--success)',
            'rejected': 'var(--danger)'
        };
        select.style.borderColor = colors[select.value];
    });
</script>
{% endblock %}